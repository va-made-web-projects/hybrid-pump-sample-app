"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3123],{3123:(A,F,a)=>{a.r(F),a.d(F,{AdminPageModule:()=>Z});var D=a(3887),l=a(177),C=a(4341),i=a(4742),I=a(486),e=a(4438),f=a(1727),v=a(467);const S=(0,a(5083).F3)("App",{web:()=>a.e(9303).then(a.bind(a,9303)).then(n=>new n.AppWeb)});var g=a(8254);let h=(()=>{var n;class s{constructor(){this.startTime=0,this.totalUsageTime=0,this.isTracking=!1,this.storageKey="app_usage_time",this.initStorage(),this.initAppStateListeners()}ngOnInit(){}initStorage(){var t=this;return(0,v.A)(function*(){yield t.loadSavedUsageTime()})()}loadSavedUsageTime(){var t=this;return(0,v.A)(function*(){const o=yield g.p.get({key:t.storageKey});o.value?console.log("Key exists with value:",o.value):(yield g.p.set({key:t.storageKey,value:"0"}),console.log("Key not found. Default value set.")),t.totalUsageTime=o?parseInt(o.value,10):0})()}initAppStateListeners(){var t=this;S.addListener("appStateChange",function(){var o=(0,v.A)(function*(c){c.isActive?(console.log("App is active"),t.startTracking()):(t.stopTracking(),yield t.saveUsageTime())});return function(c){return o.apply(this,arguments)}}())}saveUsageTime(){var t=this;return(0,v.A)(function*(){yield g.p.set({key:t.storageKey,value:t.totalUsageTime.toString()})})()}startTracking(){this.isTracking||(this.startTime=Date.now(),this.isTracking=!0)}trackUpdate(){this.isTracking&&(this.totalUsageTime+=1e3,this.saveUsageTime())}stopTracking(){if(this.isTracking){const t=Date.now();this.totalUsageTime+=t-this.startTime,this.isTracking=!1}}getTotalUsageTime(){return this.totalUsageTime}getTotalUsageTimeFormatted(){return this.trackUpdate(),`${Math.floor(this.totalUsageTime/36e5)}h ${Math.floor(this.totalUsageTime%36e5/6e4)}m ${Math.floor(this.totalUsageTime%6e4/1e3)}s`}resetUsageTime(){var t=this;return(0,v.A)(function*(){t.totalUsageTime=0,t.startTime=0,t.isTracking=!1,yield t.saveUsageTime()})()}}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),s})();var T=a(9705);let m=(()=>{var n;class s{constructor(t){this.appUsageService=t,this.usageTime="0h 0m 0s"}ngOnInit(){this.startUpdateTimer()}ngOnDestroy(){}startUpdateTimer(){this.appUsageService.startTracking(),setInterval(()=>{this.usageTime=this.appUsageService.getTotalUsageTimeFormatted()},1e3)}resetUsageTime(){this.appUsageService.resetUsageTime()}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(h))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-app-usage-tracker"]],decls:10,vars:1,consts:[["color","primary"],["popoverContent","Displays the total time the app has been used",1,"ion-no-padding"],["color","warning",3,"click"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"App Usage Time"),e.k0s(),e.nrm(4,"app-info-button",1),e.k0s(),e.j41(5,"ion-card-content")(6,"p"),e.EFF(7),e.k0s(),e.j41(8,"ion-button",2),e.bIt("click",function(){return o.resetUsageTime()}),e.EFF(9,"Reset Usage Time"),e.k0s()()()),2&t&&(e.R7$(7),e.SpI("Total Usage Time: ",o.usageTime,""))},dependencies:[i.Jm,i.b_,i.I9,i.Dg,i.he,T.S]}),s})(),d=(()=>{var n;class s{constructor(){}ngOnInit(){}}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-time-not-synced-popover"]],decls:4,vars:0,consts:[["lines","none"],[1,"ion-text-wrap"]],template:function(t,o){1&t&&(e.j41(0,"ion-content")(1,"ion-item",0)(2,"ion-label",1),e.EFF(3,' The time is not synced. Please update time with "Set Time to Device". '),e.k0s()()())},dependencies:[i.W9,i.uz,i.he]}),s})();var u=a(6893);function U(n,s){1&n&&(e.j41(0,"ion-item")(1,"ion-label",6),e.EFF(2,' The time is not synced. Please update time with "Set Time to Device". '),e.k0s()())}let b=(()=>{var n;class s{constructor(t,o,c,y){this.bluetoothControlsService=t,this.bluetoothConnectionService=o,this.toastController=c,this.popoverController=y,this.currentTime=new Date,this.bluetoothTime=null,this.timeDifference=0,this.isTimeSynced=!0}ngOnInit(){this.updateCurrentTime()}updateCurrentTime(){setInterval(()=>{this.currentTime=new Date((new Date).getTime()/1e3),this.currentTime=new Date(1e3*this.currentTime.getTime())},1e3)}checkTimeDifference(){this.bluetoothTime&&(this.timeDifference=Math.abs(this.currentTime.getTime()-this.bluetoothTime.getTime()),this.isTimeSynced=this.timeDifference<=1e4)}updateBluetoothTime(){this.bluetoothTime&&(this.bluetoothTime=new Date(this.bluetoothTime.getTime()+1e3),this.checkTimeDifference())}onReadTime(t){var o=this;return(0,v.A)(function*(){try{const c=o.bluetoothConnectionService.deviceIDSignal(),y=yield o.bluetoothControlsService.readTimestamp(c);o.bluetoothTime=new Date(1e3*new Date(y).getTime()),o.checkTimeDifference(),o.isTimeSynced||o.openSyncPopover(t),o.updateBluetoothTime()}catch{o.showToast("Failed to read time from Bluetooth device.")}})()}onWriteTime(){var t=this;return(0,v.A)(function*(){try{const o=(new Date).getTime(),c=Math.floor(o/1e3),y=t.bluetoothConnectionService.deviceIDSignal();yield t.bluetoothControlsService.writeTimestamp(y,c),t.showToast("Time successfully written to Bluetooth device.")}catch{t.showToast("Failed to write time to Bluetooth device.")}t.onReadTime(event)})()}showToast(t){var o=this;return(0,v.A)(function*(){(yield o.toastController.create({message:t,duration:2e3,position:"bottom"})).present()})()}openSyncPopover(t){var o=this;return(0,v.A)(function*(){o.isTimeSynced||(yield(yield o.popoverController.create({component:d,event:t,translucent:!0})).present())})()}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(u.I),e.rXU(f.c),e.rXU(i.K_),e.rXU(i.IE))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-bluetooth-time"]],decls:23,vars:12,consts:[["color","primary"],["color","primary","mode","ios"],["mode","ios",3,"color"],[4,"ngIf"],["color","primary","fill","solid","shape","round",3,"click"],["color","success","fill","solid","shape","round",3,"click"],["color","warning",1,"ion-text-center"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"Device Time"),e.k0s()(),e.j41(4,"ion-item")(5,"ion-label"),e.EFF(6,"Current Time"),e.k0s(),e.j41(7,"ion-badge",1),e.EFF(8),e.nI1(9,"date"),e.k0s()(),e.j41(10,"ion-item")(11,"ion-label"),e.EFF(12,"Hybrid Pump Time"),e.k0s(),e.j41(13,"ion-badge",2),e.EFF(14),e.nI1(15,"date"),e.k0s()(),e.DNE(16,U,3,0,"ion-item",3),e.j41(17,"div")(18,"ion-buttons")(19,"ion-button",4),e.bIt("click",function(y){return o.onReadTime(y)}),e.EFF(20,"Read Time from Device"),e.k0s(),e.j41(21,"ion-button",5),e.bIt("click",function(){return o.onWriteTime()}),e.EFF(22,"Set Time to Device"),e.k0s()()()()),2&t&&(e.AVh("highlight",!o.isTimeSynced),e.R7$(8),e.JRh(e.i5U(9,6,o.currentTime,"mediumTime")),e.R7$(5),e.Y8G("color",o.isTimeSynced?"primary":"danger"),e.R7$(),e.JRh(e.i5U(15,9,o.bluetoothTime,"mediumTime")),e.R7$(2),e.Y8G("ngIf",!o.isTimeSynced))},dependencies:[l.bT,i.In,i.Jm,i.QW,i.b_,i.uz,i.Dg,i.he,l.vh]}),s})(),_=(()=>{var n;class s{constructor(t,o){this.bluetoothControlsService=t,this.bluetoothConnectionService=o,this.isWriting=!1}ngOnInit(){var t=this;return(0,v.A)(function*(){yield t.refreshWritingStatus()})()}refreshWritingStatus(){var t=this;return(0,v.A)(function*(){const o=t.bluetoothConnectionService.deviceIDSignal();t.isWriting=yield t.bluetoothControlsService.readWritingData(o)})()}toggleWritingData(){var t=this;return(0,v.A)(function*(){const o=t.bluetoothConnectionService.deviceIDSignal(),c=(new Date).getTime(),y=Math.floor(c/1e3);yield t.bluetoothControlsService.writeTimestamp(o,y);const E=!t.isWriting;yield t.bluetoothControlsService.writeWritingData(o,E),t.isWriting=E})()}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(u.I),e.rXU(f.c))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-start-writing"]],decls:11,vars:4,consts:[["color","primary"],["popoverContent","Start or stop recording data",1,"ion-no-padding"],["slot","end",3,"color"],[3,"click","color"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"Writing Data Status"),e.k0s(),e.nrm(4,"app-info-button",1),e.k0s(),e.j41(5,"ion-card-content")(6,"ion-item")(7,"ion-badge",2),e.EFF(8),e.k0s(),e.j41(9,"ion-button",3),e.bIt("click",function(){return o.toggleWritingData()}),e.EFF(10),e.k0s()()()()),2&t&&(e.R7$(7),e.Y8G("color",o.isWriting?"success":"danger"),e.R7$(),e.SpI(" ",o.isWriting?"Writing":"Not Writing"," "),e.R7$(),e.Y8G("color",o.isWriting?"danger":"success"),e.R7$(),e.SpI(" ",o.isWriting?"Stop Writing":"Start Writing"," "))},dependencies:[i.In,i.Jm,i.b_,i.I9,i.uz,i.Dg,i.he,T.S]}),s})();var k=a(7982),P=a(5432),R=a(5816);let w=(()=>{var n;class s{constructor(t,o){this.bluetoothControlsService=t,this.bluetoothConnectionService=o}readMotor(){const t=this.bluetoothConnectionService.deviceIDSignal();this.bluetoothControlsService.onReadMotorRunTimeLimit(t)}ngOnInit(){this.readMotor()}ionViewWillEnter(){console.log("ionViewWillEnter"),this.readMotor()}rangeChange(t){this.bluetoothControlsService.motorRunTimeLimitSignal.set(t.detail.value)}onSaveButtonClick(){const t=R.N.setPumpStateDataView(this.bluetoothControlsService.motorRunTimeLimitSignal()),o=this.bluetoothConnectionService.deviceIDSignal();k.E.onWriteDataWithoutResponse(o,P.T.normalTimerCharUUID,t,P.T.pressureServiceUUID)}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(u.I),e.rXU(f.c))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-limit-timer"]],decls:15,vars:2,consts:[["color","primary"],["popoverContent","Set how long the motor will run (in seconds) before timing out if the threshold is not met",1,"ion-no-padding"],[1,"thresh-badge"],[1,"ion-padding-horizontal"],["color","primary","mode","ios",1,"ion-padding-horizontal"],["min","0","max","30","pin","true","snaps","true","step","1",3,"ionChange","value"],[1,"ion-text-center"],[3,"click"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"Motor Run Time Limit"),e.k0s(),e.nrm(4,"app-info-button",1),e.k0s(),e.j41(5,"ion-item",2)(6,"p",3),e.EFF(7,"Run Time: (secs)"),e.k0s(),e.j41(8,"ion-badge",4),e.EFF(9),e.k0s()(),e.j41(10,"ion-item")(11,"ion-range",5),e.bIt("ionChange",function(y){return o.rangeChange(y)}),e.k0s()(),e.j41(12,"div",6)(13,"ion-button",7),e.bIt("click",function(){return o.onSaveButtonClick()}),e.EFF(14,"Save "),e.k0s()()()),2&t&&(e.R7$(9),e.JRh(o.bluetoothControlsService.motorRunTimeLimitSignal()),e.R7$(2),e.Y8G("value",o.bluetoothControlsService.motorRunTimeLimitSignal()))},dependencies:[i.In,i.Jm,i.b_,i.uz,i.Dg,i.he,i.Ob,i.su,T.S]}),s})();var j=a(8263);let W=(()=>{var n;class s{transform(t,o=2){if(0===t)return"0 Bytes";const E=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,E)).toFixed(o))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][E]}}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.EJ8({name:"fileSize",type:n,pure:!0}),s})(),$=(()=>{var n;class s{constructor(t){this.pageDataService=t,this.capacity=16777216,this.usage=0,this.usagePercentage=0}ngOnInit(){this.getUsage(),this.calculateUsagePercentage(),setInterval(()=>{this.getUsage(),this.calculateUsagePercentage()},1e3)}getUsage(){this.pageDataService.readCurrentPage().then(t=>{null!==t&&(this.usage=256*t)})}ngOnChanges(){this.calculateUsagePercentage()}calculateUsagePercentage(){this.usagePercentage=this.capacity>0?this.usage/this.capacity*100:0}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(j.P))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-storage-usage"]],inputs:{capacity:"capacity",usage:"usage"},features:[e.OA$],decls:14,vars:11,consts:[["color","primary"],["popoverContent","Displays the amount of storage used by the app",1,"ion-no-padding"],[3,"value"],[1,"ion-text-center"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"Storage Use"),e.k0s(),e.nrm(4,"app-info-button",1),e.k0s(),e.j41(5,"ion-card-content")(6,"p"),e.EFF(7),e.nI1(8,"fileSize"),e.nI1(9,"fileSize"),e.k0s(),e.nrm(10,"ion-progress-bar",2),e.j41(11,"p",3),e.EFF(12),e.nI1(13,"number"),e.k0s()()()),2&t&&(e.R7$(7),e.Lme(" Used: ",e.bMT(8,4,o.usage)," / ",e.bMT(9,6,o.capacity)," "),e.R7$(3),e.Y8G("value",o.usagePercentage/100),e.R7$(2),e.SpI(" ",e.i5U(13,8,o.usagePercentage,"1.2-2"),"% Used "))},dependencies:[i.b_,i.I9,i.Dg,i.he,i.FH,T.S,l.QX,W]}),s})();function O(n,s){1&n&&(e.j41(0,"ion-badge",7),e.EFF(1,"Hybrid"),e.k0s())}function V(n,s){1&n&&(e.j41(0,"ion-badge",8),e.EFF(1,"Silent"),e.k0s())}function G(n,s){1&n&&(e.j41(0,"ion-badge",9),e.EFF(1,"Diagnostic"),e.k0s())}function L(n,s){if(1&n){const r=e.RV6();e.j41(0,"ion-button",10),e.bIt("click",function(){const o=e.eBV(r).$implicit,c=e.XpG();return e.Njj(c.setPumpState(o.value))}),e.EFF(1),e.k0s()}if(2&n){const r=s.$implicit,t=e.XpG();e.AVh("inactive",r.value===t.bluetoothControlService.pumpStateSignal()),e.Y8G("color",r.color)("disabled",r.value===t.bluetoothControlService.pumpStateSignal()),e.R7$(),e.SpI(" ",r.label," ")}}let X=(()=>{var n;class s{constructor(t,o){this.bluetoothControlService=t,this.bluetoothConnectionService=o,this.types=[],this.user_types=[{value:0,label:"Hybrid",color:"success"},{value:1,label:"Silent",color:"danger"}],this.admin_types=[{value:0,label:"Hybrid",color:"success"},{value:1,label:"Silent",color:"danger"},{value:2,label:"Diagnostic",color:"warning"}]}ngOnInit(){this.types="user"===this.pumpType?this.user_types:this.admin_types}setPumpState(t){const o=this.bluetoothConnectionService.deviceIDSignal();this.bluetoothControlService.setPumpState(o,t)}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(u.I),e.rXU(f.c))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-pump-type-control"]],inputs:{pumpType:"pumpType"},decls:15,vars:5,consts:[["color","primary"],["popoverContent","Switch the running pump type with the button below",1,"ion-no-padding"],[3,"ngSwitch"],["class","badge","color","success",4,"ngSwitchCase"],["class","badge","color","danger",4,"ngSwitchCase"],["class","badge","color","warning",4,"ngSwitchCase"],["class","ion-margin",3,"color","disabled","inactive","click",4,"ngFor","ngForOf"],["color","success",1,"badge"],["color","danger",1,"badge"],["color","warning",1,"badge"],[1,"ion-margin",3,"click","color","disabled"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"Pump Type"),e.k0s(),e.nrm(4,"app-info-button",1),e.k0s(),e.j41(5,"ion-list")(6,"ion-item")(7,"ion-label"),e.EFF(8,"Current Pump Status"),e.k0s(),e.qex(9,2),e.DNE(10,O,2,0,"ion-badge",3)(11,V,2,0,"ion-badge",4)(12,G,2,0,"ion-badge",5),e.bVm(),e.k0s(),e.j41(13,"ion-list"),e.DNE(14,L,2,5,"ion-button",6),e.k0s()()()),2&t&&(e.R7$(9),e.Y8G("ngSwitch",o.bluetoothControlService.pumpStateSignal()),e.R7$(),e.Y8G("ngSwitchCase",0),e.R7$(),e.Y8G("ngSwitchCase",1),e.R7$(),e.Y8G("ngSwitchCase",2),e.R7$(2),e.Y8G("ngForOf",o.types))},dependencies:[l.Sq,l.ux,l.e1,i.In,i.Jm,i.b_,i.uz,i.Dg,i.he,i.nf,T.S],styles:['ion-button.inactive[_ngcontent-%COMP%]{position:relative;pointer-events:none}ion-button.inactive[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:repeating-linear-gradient(45deg,#80808066,#80808066 10px,#80808033 10px,#80808033 20px);border-radius:4px;pointer-events:none}']}),s})();var B=a(9367),M=a(3196);function N(n,s){if(1&n){const r=e.RV6();e.j41(0,"ion-item-group")(1,"ion-item-divider",3)(2,"ion-label"),e.EFF(3,"Thresholds"),e.k0s(),e.nrm(4,"app-info-button",4),e.k0s(),e.j41(5,"ion-item",5)(6,"p",6),e.EFF(7,"Lower:"),e.k0s(),e.j41(8,"ion-badge",7),e.EFF(9),e.k0s(),e.j41(10,"p",6),e.EFF(11,"Upper: "),e.k0s(),e.j41(12,"ion-badge",7),e.EFF(13),e.k0s()(),e.j41(14,"ion-item")(15,"ion-range",8),e.bIt("ionChange",function(o){e.eBV(r);const c=e.XpG();return e.Njj(c.rangeChange(o))}),e.k0s()()()}if(2&n){const r=e.XpG();e.R7$(9),e.JRh(r.thresholds.upper),e.R7$(4),e.JRh(r.thresholds.lower),e.R7$(2),e.Y8G("dualKnobs",!0)("value",r.thresholds)}}function K(n,s){if(1&n){const r=e.RV6();e.j41(0,"ion-item-group")(1,"ion-item-divider",3)(2,"ion-label"),e.EFF(3,"Thresholds"),e.k0s()(),e.j41(4,"ion-item",5)(5,"p",6),e.EFF(6,"Threshold: "),e.k0s(),e.j41(7,"ion-badge",7),e.EFF(8),e.k0s()(),e.j41(9,"ion-item")(10,"ion-range",9),e.bIt("ionChange",function(o){e.eBV(r);const c=e.XpG();return e.Njj(c.singleRangeChange(o))}),e.k0s()()()}if(2&n){const r=e.XpG();e.R7$(8),e.JRh(r.thresholds.lower),e.R7$(2),e.Y8G("dualKnobs",!1)("value",r.thresholds)}}let Y=(()=>{var n;class s{constructor(t,o,c){this.deviceSettingsService=t,this.bluetoothConnectionService=o,this.toastController=c,this.device=this.deviceSettingsService.state.asReadonly(),this.upper=this.deviceSettingsService.select("upperThresh"),this.lower=this.deviceSettingsService.select("lowerThresh"),this.thresholds={lower:this.upper(),upper:this.lower()}}ngOnInit(){}ionViewWillEnter(){this.upper=this.deviceSettingsService.select("upperThresh"),this.lower=this.deviceSettingsService.select("lowerThresh")}rangeChange(t){this.deviceSettingsService.set("lowerThresh",t.detail.value.lower),this.deviceSettingsService.set("upperThresh",t.detail.value.upper),this.thresholds={lower:this.upper(),upper:this.lower()}}singleRangeChange(t){this.deviceSettingsService.set("lowerThresh",t.detail.value.lower),this.thresholds={lower:this.upper(),upper:this.lower()},this.presentToast()}onSaveButtonClick(){const t=this.bluetoothConnectionService.deviceIDSignal(),o=R.N.setUint32DataView(B.n.inchesToMillivolts(this.deviceSettingsService.select("lowerThresh")())),c=R.N.setUint32DataView(B.n.inchesToMillivolts(this.deviceSettingsService.select("upperThresh")()));k.E.onWriteDataWithoutResponse(t,P.T.lowThreshCharUUID,o,P.T.pressureServiceUUID),k.E.onWriteDataWithoutResponse(t,P.T.highThreshCharUUID,c,P.T.pressureServiceUUID),this.presentToast()}presentToast(){this.toastController.create({message:"Threshold saved",color:"success",position:"middle",duration:2e3}).then(t=>{t.present()})}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(M.r),e.rXU(f.c),e.rXU(i.K_))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-pump-threshold"]],inputs:{userType:"userType"},decls:6,vars:2,consts:[[4,"ngIf"],[1,"ion-text-center"],[3,"click"],["color","primary"],["popoverContent","Set the high and low threshold for the pump in inHg",1,"ion-no-padding"],[1,"thresh-badge"],[1,"ion-padding-horizontal"],["color","primary","mode","ios",1,"ion-padding-horizontal"],["min","10","max","20","pin","true","snaps","true","step","1","aria-label","Dual Knobs Range",3,"ionChange","dualKnobs","value"],["min","10","max","20","pin","true","snaps","true","step","1",3,"ionChange","dualKnobs","value"]],template:function(t,o){1&t&&(e.j41(0,"ion-card"),e.DNE(1,N,16,4,"ion-item-group",0)(2,K,11,3,"ion-item-group",0),e.j41(3,"div",1)(4,"ion-button",2),e.bIt("click",function(){return o.onSaveButtonClick()}),e.EFF(5,"Save "),e.k0s()()()),2&t&&(e.R7$(),e.Y8G("ngIf","admin"===o.userType),e.R7$(),e.Y8G("ngIf","user"===o.userType))},dependencies:[l.bT,i.In,i.Jm,i.b_,i.uz,i.Dg,i.jh,i.he,i.Ob,i.su,T.S]}),s})(),z=(()=>{var n;class s{constructor(t,o,c,y){this.bluetoothControlService=t,this.bluetoothConnectionService=o,this.toastController=c,this.deviceSettingsService=y,this.actionSheetButtons=[{text:"Reset",role:"destructive",data:{action:"reset"},handler:()=>{console.log("Reset clicked");const E=this.bluetoothConnectionService.deviceIDSignal();this.bluetoothControlService.writeNVSResetData(E,!0,this.deviceSettingsService),this.presentToast()}},{text:"Cancel",role:"cancel",data:{action:"cancel"},handler:()=>{console.log("Cancel clicked")}}]}ngOnInit(){}presentToast(){this.toastController.create({message:"NVS data reset",color:"warning",duration:2e3,position:"top"}).then(t=>t.present())}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(u.I),e.rXU(f.c),e.rXU(i.K_),e.rXU(M.r))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-reset-nvs"]],decls:10,vars:1,consts:[["color","primary"],["popoverContent","Reset all Hybrid Pump settings to default",1,"ion-no-padding"],["id","open-action-sheet","color","danger"],["trigger","open-action-sheet","header","Are you sure you want to RESET the DEVICE?",3,"buttons"]],template:function(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-item-divider",0)(2,"ion-label"),e.EFF(3,"Reset Settings Data Status"),e.k0s(),e.nrm(4,"app-info-button",1),e.k0s(),e.j41(5,"ion-card-content")(6,"ion-item")(7,"ion-button",2),e.EFF(8,"Reset NVS"),e.k0s(),e.nrm(9,"ion-action-sheet",3),e.k0s()()()),2&t&&(e.R7$(9),e.Y8G("buttons",o.actionSheetButtons))},dependencies:[i.wC,i.Jm,i.b_,i.I9,i.uz,i.Dg,i.he,T.S]}),s})();function x(n,s){1&n&&(e.j41(0,"div")(1,"ion-card")(2,"ion-card-content")(3,"ion-label"),e.EFF(4,"Not Connected to Device"),e.k0s()()()())}function J(n,s){1&n&&(e.j41(0,"div")(1,"div"),e.nrm(2,"app-pump-type-control",4),e.k0s(),e.j41(3,"div"),e.nrm(4,"app-pump-threshold",5),e.k0s(),e.j41(5,"div"),e.nrm(6,"app-limit-timer"),e.k0s(),e.j41(7,"div"),e.nrm(8,"app-bluetooth-time"),e.k0s(),e.j41(9,"div"),e.nrm(10,"app-start-writing"),e.k0s(),e.j41(11,"div"),e.nrm(12,"app-storage-usage"),e.k0s(),e.j41(13,"div"),e.nrm(14,"app-app-usage-tracker"),e.k0s(),e.j41(15,"div"),e.nrm(16,"app-reset-nvs"),e.k0s()())}const H=[{path:"",component:(()=>{var n;class s{constructor(t){this.bluetoothConnectionService=t}ngOnInit(){}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(f.c))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-admin"]],decls:7,vars:3,consts:[[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngIf"],["pumpType","admin"],["userType","admin"]],template:function(t,o){1&t&&(e.j41(0,"ion-content",0)(1,"ion-header",1)(2,"ion-toolbar")(3,"ion-title",2),e.EFF(4,"Admin Page"),e.k0s()()(),e.DNE(5,x,5,0,"div",3)(6,J,17,0,"div",3),e.k0s()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(5),e.Y8G("ngIf",!o.bluetoothConnectionService.connectionStatus()),e.R7$(),e.Y8G("ngIf",o.bluetoothConnectionService.connectionStatus()))},dependencies:[l.bT,i.b_,i.I9,i.W9,i.eU,i.he,i.BC,i.ai,m,b,_,w,$,X,Y,z]}),s})()}];let Q=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[I.iI.forChild(H),I.iI]}),s})(),Z=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[l.MD,C.YN,i.bv,Q,D.G]}),s})()},9855:(A,F,a)=>{a.d(F,{Y:()=>I});var D=a(467),l=a(4438),C=a(3643),i=a(5432);let I=(()=>{var e;class f{constructor(){this.totalPagesSignal=(0,l.vPA)(0),this.progress=(0,l.vPA)(0),this.fullFlashData=[],this.fullFlashPages=0}parseDataReading(p){const S=p.byteLength;if(S%16!=0)throw new Error("Data length is not a multiple of 16 bytes.");const h=[];for(let T=0;T<S&&!(T+16>S);T+=16){const m=p.getUint32(T,!0),d=p.getUint16(T+4,!0),u=p.getUint8(T+6),U=!!(128&u),b=127&u,_=p.getUint16(T+7,!0),k=p.getUint16(T+9,!0),P=p.getUint16(T+11,!0);h.push({timestamp:Number(m),sensorValue:d,isMotorRunning:U,pumpMode:b,batteryReading:_,lowThreshold:k,highThreshold:P})}return h}onReadFlashData(p){var S=this;return(0,D.A)(function*(){S.readTotalPages(p),S.fullFlashPages=0;const g=i.T.dataServiceUUID,h=i.T.readFullFlashCharUUID;yield C.Fk.read(p,g,h)})()}readTotalPages(p){var S=this;return(0,D.A)(function*(){try{const h=(yield yield C.Fk.read(p,i.T.deviceServiceUUID,i.T.totalPagesCharUUID)).getUint32(0,!0);return S.totalPagesSignal.set(h),h}catch(g){throw console.error("Error reading total pages:",g),g}})()}}return(e=f).\u0275fac=function(p){return new(p||e)},e.\u0275prov=l.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),f})()},8263:(A,F,a)=>{a.d(F,{P:()=>p});var D=a(467),l=a(4438),C=a(5432),i=a(3643),I=a(5816);class e{static parseDataReading(h){const T=h.byteLength;if(T%16!=0)throw new Error("Data length is not a multiple of 16 bytes.");const d=[];for(let u=0;u<T&&!(u+16>T);u+=16){const U=h.getUint32(u,!0),b=h.getUint16(u+4,!0),_=h.getUint8(u+6),k=!!(128&_),P=127&_,R=h.getUint16(u+7,!0),w=h.getUint16(u+9,!0),j=h.getUint16(u+11,!0);d.push({timestamp:Number(U),sensorValue:b,isMotorRunning:k,pumpMode:P,batteryReading:R,lowThreshold:w,highThreshold:j})}return d}}var f=a(1727),v=a(9855);let p=(()=>{var g;class h{constructor(m,d){this.bluetoothConnectionService=m,this.bluetoothDataService=d,this.allPageData=(0,l.vPA)([]),this.singlePageData=(0,l.vPA)([])}readCurrentPage(){var m=this;return(0,D.A)(function*(){try{const d=yield i.Fk.read(m.bluetoothConnectionService.deviceIDSignal(),C.T.dataServiceUUID,C.T.currentPageCharUUID);return d.byteLength>0?I.N.parseInt32DataReading(d):(console.log("No page number received from device"),null)}catch(d){return console.error("Error reading page number:",d),null}})()}readPageData(m){var d=this;return(0,D.A)(function*(){try{const u=new DataView(new ArrayBuffer(4));u.setInt32(0,256*m,!0),console.log(`Setting page offset to ${m}`),console.log("Page offset buffer:",u),yield i.Fk.write(d.bluetoothConnectionService.deviceIDSignal(),C.T.dataServiceUUID,C.T.pageOffsetWriteCharUUID,u),console.log(`Reading data for page ${m}`);const b=yield i.Fk.read(d.bluetoothConnectionService.deviceIDSignal(),C.T.dataServiceUUID,C.T.pageDataCharUUID);return b.byteLength>0?(console.log(`Page ${m} data:`,b),Array.from(e.parseDataReading(b))):(console.log(`No data received for page ${m}`),null)}catch(u){return console.error(`Error reading data for page ${m}:`,u),null}})()}readMultiplePages(m,d,u=5){var U=this;return(0,D.A)(function*(){const b=[];for(let _=0;_<d;_+=u){const k=Array.from({length:Math.min(u,d-_)},(R,w)=>U.readPageData(m+_+w)),P=yield Promise.all(k);b.push(...P.filter(R=>null!==R).flat())}return b})()}readSinglePage(m){var d=this;return(0,D.A)(function*(){const u=yield d.readCurrentPage();if(null===u)return console.error("Could not determine current page"),[];if(m>u)return console.error("Page number is greater than current page"),[];console.log(`Reading single page ${m}`);const U=yield d.readPageData(m);return S(U)})()}readAllPages(){var m=this;return(0,D.A)(function*(){const d=yield m.readCurrentPage();if(null===d)return console.error("Could not determine current page"),[];const u=[];for(let b=0;b<d;b++){m.bluetoothDataService.progress.set(b/(d-1)),console.log(`Reading page ${b}`);const _=yield m.readPageData(b);null!==_&&u.push(..._)}const U=S(u);return m.allPageData.set(U),U})()}}return(g=h).\u0275fac=function(m){return new(m||g)(l.KVO(f.c),l.KVO(v.Y))},g.\u0275prov=l.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),h})();const S=g=>(g=g.filter(h=>255!==h.sensorValue)).map(h=>({...h,timestamp:1e3*h.timestamp}))},9705:(A,F,a)=>{a.d(F,{S:()=>I});var D=a(467),l=a(4438),C=a(4742);let i=(()=>{var e;class f{constructor(p){this.popoverController=p,this.content=""}ngOnInit(){}}return(e=f).\u0275fac=function(p){return new(p||e)(l.rXU(C.IE))},e.\u0275cmp=l.VBU({type:e,selectors:[["app-info-popover"]],inputs:{content:"content"},decls:3,vars:1,consts:[[1,"ion-padding"]],template:function(p,S){1&p&&(l.j41(0,"ion-content")(1,"div",0),l.EFF(2),l.k0s()()),2&p&&(l.R7$(2),l.SpI(" ",S.content," "))},dependencies:[C.W9]}),f})(),I=(()=>{var e;class f{constructor(p){this.popoverController=p,this.popoverContent=""}ngOnInit(){}presentPopover(p){var S=this;return(0,D.A)(function*(){yield(yield S.popoverController.create({component:i,componentProps:{content:S.popoverContent},event:p,translucent:!0})).present()})()}}return(e=f).\u0275fac=function(p){return new(p||e)(l.rXU(C.IE))},e.\u0275cmp=l.VBU({type:e,selectors:[["app-info-button"]],inputs:{popoverContent:"popoverContent"},decls:2,vars:0,consts:[["fill","clear","color","medium",1,"info-button",3,"click"],["name","information-circle-outline"]],template:function(p,S){1&p&&(l.j41(0,"ion-button",0),l.bIt("click",function(h){return S.presentPopover(h)}),l.nrm(1,"ion-icon",1),l.k0s())},dependencies:[C.Jm,C.iq],styles:[".info-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:1}"]}),f})()},3887:(A,F,a)=>{a.d(F,{G:()=>I});var D=a(177),l=a(4742),C=a(4341),i=a(4438);let I=(()=>{var e;class f{}return(e=f).\u0275fac=function(p){return new(p||e)},e.\u0275mod=i.$C({type:e}),e.\u0275inj=i.G2t({imports:[D.MD,l.bv,C.YN]}),f})()}}]);